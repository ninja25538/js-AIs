
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Genetic Algorithm</title>
</head>
<body>
<p id="gen"></p>
<canvas id="canvas"></canvas>
  <script>

    //Much credit to Arjes on Reddit for helping me out!

var c=document.getElementById("canvas");
var ctx=c.getContext("2d");
ctx.canvas.width = window.innerWidth - 75;
ctx.canvas.height = window.innerHeight - 75;

var startingX = 50;
var startingY = 250;

var playerPositions;

var movesThisGeneration;
var bestPathFound = [];

var plantX = 80;
var plantY = ctx.canvas.height - 50;

var plantWidth = 300;
var plantHeight = 50;

var generations = -1;

function drawPlayerBest(){

}

function drawPlayer1(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player1.x - 5, playerPositions.player1.y - 5, 20, 20);
  ctx.fillStyle = "red";
  ctx.fillRect(playerPositions.player1.x, playerPositions.player1.y, 5, 5);
}

function drawPlayer2(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player2.x - 5, playerPositions.player2.y - 5, 20, 20);
  ctx.fillStyle = "orange";
  ctx.fillRect(playerPositions.player2.x, playerPositions.player2.y, 5, 5);
}

function drawPlayer3(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player3.x - 5, playerPositions.player3.y - 5, 20, 20);
  ctx.fillStyle = "yellow";
  ctx.fillRect(playerPositions.player3.x, playerPositions.player3.y, 5, 5);

}

function drawPlayer4(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player4.x - 5, playerPositions.player4.y - 5, 20, 20);
  ctx.fillStyle = "green";
  ctx.fillRect(playerPositions.player4.x, playerPositions.player4.y, 5, 5);
}

function drawPlayer5(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player5.x - 5, playerPositions.player5.y - 5, 20, 20);
  ctx.fillStyle = "blue";
  ctx.fillRect(playerPositions.player5.x, playerPositions.player5.y, 5, 5);
}

function drawPlayer6(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player6.x - 5, playerPositions.player6.y - 5, 20, 20);
  ctx.fillStyle = "indigo";
  ctx.fillRect(playerPositions.player6.x, playerPositions.player6.y, 5, 5);
}

function drawPlayer7(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player7.x - 5, playerPositions.player7.y - 5, 20, 20);
  ctx.fillStyle = "violet";
  ctx.fillRect(playerPositions.player7.x, playerPositions.player7.y, 5, 5);
}


function drawPlayer8(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player8.x - 5, playerPositions.player8.y - 5, 20, 20);
  ctx.fillStyle = "brown";
  ctx.fillRect(playerPositions.player8.x, playerPositions.player8.y, 5, 5);
}


function drawPlayer9(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player9.x - 5, playerPositions.player9.y - 5, 20, 20);
  ctx.fillStyle = "aqua";
  ctx.fillRect(playerPositions.player9.x, playerPositions.player9.y, 5, 5);
}


function drawPlayer10(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player10.x - 5, playerPositions.player10.y - 5, 20, 20);
  ctx.fillStyle = "black";
  ctx.fillRect(playerPositions.player10.x, playerPositions.player10.y, 5, 5);
}


function drawPlayer11(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player11.x - 5, playerPositions.player11.y - 5, 20, 20);
  ctx.fillStyle = "fuchsia";
  ctx.fillRect(playerPositions.player11.x, playerPositions.player11.y, 5, 5);
}


function drawPlayer12(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player12.x - 5, playerPositions.player12.y - 5, 20, 20);
  ctx.fillStyle = "gray";
  ctx.fillRect(playerPositions.player12.x, playerPositions.player12.y, 5, 5);
}


function drawPlayer13(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player13.x - 5, playerPositions.player13.y - 5, 20, 20);
  ctx.fillStyle = "lime";
  ctx.fillRect(playerPositions.player13.x, playerPositions.player13.y, 5, 5);
}


function drawPlayer14(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player14.x - 5, playerPositions.player14.y - 5, 20, 20);
  ctx.fillStyle = "maroon";
  ctx.fillRect(playerPositions.player14.x, playerPositions.player14.y, 5, 5);
}


function drawPlayer15(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player15.x - 5, playerPositions.player15.y - 5, 20, 20);
  ctx.fillStyle = "navy";
  ctx.fillRect(playerPositions.player15.x, playerPositions.player15.y, 5, 5);
}


function drawPlayer16(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player16.x - 5, playerPositions.player16.y - 5, 20, 20);
  ctx.fillStyle = "olive";
  ctx.fillRect(playerPositions.player16.x, playerPositions.player16.y, 5, 5);
}


function drawPlayer17(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player17.x - 5, playerPositions.player17.y - 5, 20, 20);
  ctx.fillStyle = "silver";
  ctx.fillRect(playerPositions.player17.x, playerPositions.player17.y, 5, 5);
}


function drawPlayer18(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player18.x - 5, playerPositions.player18.y - 5, 20, 20);
  ctx.fillStyle = "teal";
  ctx.fillRect(playerPositions.player18.x, playerPositions.player18.y, 5, 5);
}


function drawPlayer19(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player19.x - 5, playerPositions.player19.y - 5, 20, 20);
  ctx.fillStyle = "aliceblue";
  ctx.fillRect(playerPositions.player19.x, playerPositions.player19.y, 5, 5);
}


function drawPlayer20(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player20.x - 5, playerPositions.player20.y - 5, 20, 20);
  ctx.fillStyle = "antiquewhite";
  ctx.fillRect(playerPositions.player20.x, playerPositions.player20.y, 5, 5);
}



function drawPlant(){
  ctx.fillStyle = "green";
  ctx.fillRect(plantX, plantY, plantWidth, plantHeight);
}


drawPlant();
nextGeneration();
var currentTick = 0;
function tick() {
  drawPlayer2();
  drawPlayer1();
  drawPlayer3();
  drawPlayer4();
drawPlayer5();
drawPlayer6();
drawPlayer7();
drawPlayer8();
drawPlayer9();
drawPlayer10();
drawPlayer11();
drawPlayer12();
drawPlayer13();
drawPlayer14();
drawPlayer15();
drawPlayer16();
drawPlayer17();
drawPlayer18();
drawPlayer19();
drawPlayer20();

  movePlayers();
  evaluateVictory();
  currentTick++;
  checkForFailure();
}

function checkForFailure() {
  if (bestPathFound.length && currentTick > bestPathFound.length) {
    nextGeneration();
  }
}
function movePlayers() {
  movePlayer('player1');
  movePlayer('player2');
  movePlayer('player3');
movePlayer('player4');
movePlayer('player5');
movePlayer('player6');
movePlayer('player7');
movePlayer('player8');
movePlayer('player9');
movePlayer('player10');
movePlayer('player11');
movePlayer('player12');
movePlayer('player13');
movePlayer('player14');
movePlayer('player15');
movePlayer('player16');
movePlayer('player17');
movePlayer('player18');
movePlayer('player19');
movePlayer('player20');
}

function pickDirection() {
  var directionToMove;
  // 90% chance to follow existing path. 10% chance for deviation
  if(bestPathFound.length >= currentTick && Math.random < 0.9) {
    return bestPathFound[currentTick];
  }

  if(!directionToMove) {
    switch(Math.floor(Math.random() * 4) + 1) { // Random number between ranges
      case 1:
        return 'left';
      case 2:
        return 'right';
      case 3:
        return 'up';
      case 4:
        return 'down';
    }
  }
}
function movePlayer(playerName) {
  var directionToMove = pickDirection();

  movesThisGeneration[playerName].push(directionToMove);
  switch(directionToMove) {
    case 'up':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x,
        y: playerPositions[playerName].y + 5,
      }
      break;
    case 'down':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x,
        y: playerPositions[playerName].y - 5,
      }
      break;
    case 'left':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x - 5,
        y: playerPositions[playerName].y,
      }
      break;
    case 'right':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x + 5,
        y: playerPositions[playerName].y,
      }
      break;
  }

  correctPlayerPosition(playerName);

}

function correctPlayerPosition(playerName) {
  if( playerPositions[playerName].x < 0 ) {
    playerPositions[playerName].x = 0;
  }

  if( playerPositions[playerName].x > ctx.canvas.width) {
    playerPositions[playerName].x = ctx.canvas.width;
  }

  if( playerPositions[playerName].y < 0 ) {
    playerPositions[playerName].y = 0;
  }

  if( playerPositions[playerName].y > ctx.canvas.height ) {
    playerPositions[playerName].y = ctx.canvas.height;
  }
}

function evaluateVictory() {
  if(playerPositions.player1.x >= plantX && playerPositions.player1.x <= plantX + plantWidth) {
    if(playerPositions.player1.y >= plantY && playerPositions.player1.y <= plantY + plantHeight){
    declareVictor('player1');
  console.log(bestPathFound);
    }
  }  if(playerPositions.player2.x >= plantX && playerPositions.player2.x <= plantX + plantWidth) {
    if(playerPositions.player2.y >= plantY && playerPositions.player2.y <= plantY + plantHeight){
    declareVictor('player2');
  console.log(bestPathFound);
  }
  }

if(playerPositions.player3.x >= plantX && playerPositions.player3.x <= plantX + plantWidth) {
    if(playerPositions.player3.y >= plantY && playerPositions.player3.y <= plantY + plantHeight){
    declareVictor('player3');
  console.log(bestPathFound);
    }
  } 

if(playerPositions.player4.x >= plantX && playerPositions.player4.x <= plantX + plantWidth) {
    if(playerPositions.player4.y >= plantY && playerPositions.player4.y <= plantY + plantHeight){
    declareVictor('player4');
  console.log(bestPathFound);
    }
  } 


if(playerPositions.player5.x >= plantX && playerPositions.player5.x <= plantX + plantWidth) {
    if(playerPositions.player5.y >= plantY && playerPositions.player5.y <= plantY + plantHeight){
    declareVictor('player5');
  console.log(bestPathFound);
    }
  } 


if(playerPositions.player6.x >= plantX && playerPositions.player6.x <= plantX + plantWidth) {
    if(playerPositions.player6.y >= plantY && playerPositions.player6.y <= plantY + plantHeight){
    declareVictor('player6');
  console.log(bestPathFound);
    }
  } 


if(playerPositions.player7.x >= plantX && playerPositions.player7.x <= plantX + plantWidth) {
    if(playerPositions.player7.y >= plantY && playerPositions.player7.y <= plantY + plantHeight){
    declareVictor('player7');
  console.log(bestPathFound);
    }
  } 

if(playerPositions.player8.x >= plantX && playerPositions.player8.x <= plantX + plantWidth) {
    if(playerPositions.player8.y >= plantY && playerPositions.player8.y <= plantY + plantHeight){
    declareVictor('player8');
  console.log(bestPathFound);
    }
  } 

if(playerPositions.player8.x >= plantX && playerPositions.player8.x <= plantX + plantWidth) {
    if(playerPositions.player8.y >= plantY && playerPositions.player8.y <= plantY + plantHeight){
    declareVictor('player8');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player9.x >= plantX && playerPositions.player9.x <= plantX + plantWidth) {
    if(playerPositions.player9.y >= plantY && playerPositions.player9.y <= plantY + plantHeight){
    declareVictor('player9');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player9.x >= plantX && playerPositions.player9.x <= plantX + plantWidth) {
    if(playerPositions.player9.y >= plantY && playerPositions.player9.y <= plantY + plantHeight){
    declareVictor('player9');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player10.x >= plantX && playerPositions.player10.x <= plantX + plantWidth) {
    if(playerPositions.player10.y >= plantY && playerPositions.player10.y <= plantY + plantHeight){
    declareVictor('player10');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player11.x >= plantX && playerPositions.player11.x <= plantX + plantWidth) {
    if(playerPositions.player11.y >= plantY && playerPositions.player11.y <= plantY + plantHeight){
    declareVictor('player11');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player12.x >= plantX && playerPositions.player12.x <= plantX + plantWidth) {
    if(playerPositions.player12.y >= plantY && playerPositions.player12.y <= plantY + plantHeight){
    declareVictor('player12');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player13.x >= plantX && playerPositions.player13.x <= plantX + plantWidth) {
    if(playerPositions.player13.y >= plantY && playerPositions.player13.y <= plantY + plantHeight){
    declareVictor('player13');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player14.x >= plantX && playerPositions.player14.x <= plantX + plantWidth) {
    if(playerPositions.player14.y >= plantY && playerPositions.player14.y <= plantY + plantHeight){
    declareVictor('player14');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player15.x >= plantX && playerPositions.player15.x <= plantX + plantWidth) {
    if(playerPositions.player15.y >= plantY && playerPositions.player15.y <= plantY + plantHeight){
    declareVictor('player15');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player16.x >= plantX && playerPositions.player16.x <= plantX + plantWidth) {
    if(playerPositions.player16.y >= plantY && playerPositions.player16.y <= plantY + plantHeight){
    declareVictor('player16');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player17.x >= plantX && playerPositions.player17.x <= plantX + plantWidth) {
    if(playerPositions.player17.y >= plantY && playerPositions.player17.y <= plantY + plantHeight){
    declareVictor('player17');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player18.x >= plantX && playerPositions.player18.x <= plantX + plantWidth) {
    if(playerPositions.player18.y >= plantY && playerPositions.player18.y <= plantY + plantHeight){
    declareVictor('player18');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player19.x >= plantX && playerPositions.player19.x <= plantX + plantWidth) {
    if(playerPositions.player19.y >= plantY && playerPositions.player19.y <= plantY + plantHeight){
    declareVictor('player19');
  console.log(bestPathFound);
    }
  } 
if(playerPositions.player20.x >= plantX && playerPositions.player20.x <= plantX + plantWidth) {
    if(playerPositions.player20.y >= plantY && playerPositions.player20.y <= plantY + plantHeight){
    declareVictor('player20');
  console.log(bestPathFound);
    }
  } 

}

function declareVictor(playerName) {
  if(
    !bestPathFound.length ||
    bestPathFound.length > movesThisGeneration[playerName].length
  ) {
    bestPathFound = movesThisGeneration[playerName]
  }

  nextGeneration();
}

function nextGeneration() {
  currentTick = 0;

  playerPositions = {
    player1: {x: startingX, y: startingY},
    player2: {x: startingX, y: startingY},
    player3: {x: startingX, y: startingY},
player4: {x: startingX, y: startingY},
player5: {x: startingX, y: startingY},
player6: {x: startingX, y: startingY},
player7: {x: startingX, y: startingY},
player8: {x: startingX, y: startingY},
player9: {x: startingX, y: startingY},
player10: {x: startingX, y: startingY},
player11: {x: startingX, y: startingY},
player12: {x: startingX, y: startingY},
player13: {x: startingX, y: startingY},
player14: {x: startingX, y: startingY},
player15: {x: startingX, y: startingY},
player16: {x: startingX, y: startingY},
player17: {x: startingX, y: startingY},
player18: {x: startingX, y: startingY},
player19: {x: startingX, y: startingY},
player20: {x: startingX, y: startingY}
  };

  movesThisGeneration = {
    player1: [],
    player2: [],
    player3: [],
    player4: [],
    player5: [],
    player6: [],
    player7: [],
    player8: [],
    player9: [],
    player10: [],
    player11: [],
    player12: [],
    player13: [],
    player14: [],
    player15: [],
    player16: [],
    player17: [],
    player18: [],
    player19: [],
    player20: []

  };

  generations++;
  document.getElementById("gen").innerHTML ="Number of generations so far: " + generations + " Moves to Plant: " + bestPathFound.length;
}

setInterval(tick, 1);



 
  </script>
</body>
</html>
