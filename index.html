
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>JS Genetic Algorithm</title>
</head>
<body>
<p id="gen"></p>

<script>
!function(r,e){if("object"==typeof exports){var n=e();"object"==typeof module&&module&&module.exports&&(exports=module.exports=n),exports.randomColor=n}else"function"==typeof define&&define.amd?define([],e):r.randomColor=e()}(this,function(){function r(r){var e=o(r.hue),n=i(e);return n<0&&(n=360+n),n}function e(r,e){if("monochrome"===e.hue)return 0;if("random"===e.luminosity)return i([0,100]);var n=u(r),t=n[0],a=n[1];switch(e.luminosity){case"bright":t=55;break;case"dark":t=a-10;break;case"light":a=55}return i([t,a])}function n(r,e,n){var t=a(r,e),o=100;switch(n.luminosity){case"dark":o=t+20;break;case"light":t=(o+t)/2;break;case"random":t=0,o=100}return i([t,o])}function t(r,e){switch(e.format){case"hsvArray":return r;case"hslArray":return d(r);case"hsl":var n=d(r);return"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)";case"hsla":var t=d(r),a=e.alpha||Math.random();return"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+a+")";case"rgbArray":return f(r);case"rgb":return"rgb("+f(r).join(", ")+")";case"rgba":var o=f(r),a=e.alpha||Math.random();return"rgba("+o.join(", ")+", "+a+")";default:return c(r)}}function a(r,e){for(var n=s(r).lowerBounds,t=0;t<n.length-1;t++){var a=n[t][0],o=n[t][1],u=n[t+1][0],i=n[t+1][1];if(e>=a&&e<=u){var c=(i-o)/(u-a);return c*e+(o-c*a)}}return 0}function o(r){if("number"==typeof parseInt(r)){var e=parseInt(r);if(e<360&&e>0)return[e,e]}if("string"==typeof r)if(m[r]){var n=m[r];if(n.hueRange)return n.hueRange}else if(r.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){const t=h(r)[0];return[t,t]}return[0,360]}function u(r){return s(r).saturationRange}function s(r){r>=334&&r<=360&&(r-=360);for(var e in m){var n=m[e];if(n.hueRange&&r>=n.hueRange[0]&&r<=n.hueRange[1])return m[e]}return"Color not found"}function i(r){if(null===v)return Math.floor(r[0]+Math.random()*(r[1]+1-r[0]));var e=r[1]||1,n=r[0]||0;v=(9301*v+49297)%233280;var t=v/233280;return Math.floor(n+t*(e-n))}function c(r){function e(r){var e=r.toString(16);return 1==e.length?"0"+e:e}var n=f(r);return"#"+e(n[0])+e(n[1])+e(n[2])}function l(r,e,n){var t=n[0][0],a=n[n.length-1][0],o=n[n.length-1][1],u=n[0][1];m[r]={hueRange:e,lowerBounds:n,saturationRange:[t,a],brightnessRange:[o,u]}}function f(r){var e=r[0];0===e&&(e=1),360===e&&(e=359),e/=360;var n=r[1]/100,t=r[2]/100,a=Math.floor(6*e),o=6*e-a,u=t*(1-n),s=t*(1-o*n),i=t*(1-(1-o)*n),c=256,l=256,f=256;switch(a){case 0:c=t,l=i,f=u;break;case 1:c=s,l=t,f=u;break;case 2:c=u,l=t,f=i;break;case 3:c=u,l=s,f=t;break;case 4:c=i,l=u,f=t;break;case 5:c=t,l=u,f=s}return[Math.floor(255*c),Math.floor(255*l),Math.floor(255*f)]}function h(r){r=r.replace(/^#/,""),r=3===r.length?r.replace(/(.)/g,"$1$1"):r;const e=parseInt(r.substr(0,2),16)/255,n=parseInt(r.substr(2,2),16)/255,t=parseInt(r.substr(4,2),16)/255,a=Math.max(e,n,t),o=a-Math.min(e,n,t),u=a?o/a:0;switch(a){case e:return[(n-t)/o%6*60||0,u,a];case n:return[60*((t-e)/o+2)||0,u,a];case t:return[60*((e-n)/o+4)||0,u,a]}}function d(r){var e=r[0],n=r[1]/100,t=r[2]/100,a=(2-n)*t;return[e,Math.round(n*t/(a<1?a:2-a)*1e4)/100,a/2*100]}function g(r){for(var e=0,n=0;n!==r.length&&!(e>=Number.MAX_SAFE_INTEGER);n++)e+=r.charCodeAt(n);return e}var v=null,m={};!function(){l("monochrome",null,[[0,0],[100,0]]),l("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),l("orange",[19,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),l("yellow",[47,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),l("green",[63,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),l("blue",[179,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),l("purple",[258,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),l("pink",[283,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}();var p=function(a){if(a=a||{},void 0!==a.seed&&null!==a.seed&&a.seed===parseInt(a.seed,10))v=a.seed;else if("string"==typeof a.seed)v=g(a.seed);else{if(void 0!==a.seed&&null!==a.seed)throw new TypeError("The seed value must be an integer or string");v=null}var o,u,s;if(null!==a.count&&void 0!==a.count){var i=a.count,c=[];for(a.count=null;i>c.length;)v&&a.seed&&(a.seed+=1),c.push(p(a));return a.count=i,c}return o=r(a),u=e(o,a),s=n(o,u,a),t([o,u,s],a)};return p});
//# sourceMappingURL=randomColor.min.js.map
</script>
<canvas id="canvas"></canvas>
  <script>

    //Much credit to Arjes on Reddit for helping me out!

var c=document.getElementById("canvas");
var ctx=c.getContext("2d");
ctx.canvas.width = window.innerWidth - 75;
ctx.canvas.height = window.innerHeight - 75;

var startingX = 50;
var startingY = 250;

var playerPositions;

var movesThisGeneration;
var bestPathFound = [];

var plantX = 80;
var plantY = ctx.canvas.height - 50;

var plantWidth = 300;
var plantHeight = 50;

var generations = -1;

function drawPlayerBest(){

}

function drawPlayer1(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player1.x - 5, playerPositions.player1.y - 5, 20, 20);
  ctx.fillStyle = "red";
  ctx.fillRect(playerPositions.player1.x, playerPositions.player1.y, 5, 5);
}

function drawPlayer2(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player2.x - 5, playerPositions.player2.y - 5, 20, 20);
  ctx.fillStyle = "orange";
  ctx.fillRect(playerPositions.player2.x, playerPositions.player2.y, 5, 5);
}

function drawPlayer3(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player3.x - 5, playerPositions.player3.y - 5, 20, 20);
  ctx.fillStyle = "yellow";
  ctx.fillRect(playerPositions.player3.x, playerPositions.player3.y, 5, 5);

}

function drawPlayer4(){
  ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player4.x - 5, playerPositions.player4.y - 5, 20, 20);
  ctx.fillStyle = "green";
  ctx.fillRect(playerPositions.player4.x, playerPositions.player4.y, 5, 5);
}

function drawPlayer5(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player5.x - 5, playerPositions.player5.y - 5, 20, 20);
  ctx.fillStyle = "blue";
  ctx.fillRect(playerPositions.player5.x, playerPositions.player5.y, 5, 5);
}

function drawPlayer6(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player6.x - 5, playerPositions.player6.y - 5, 20, 20);
  ctx.fillStyle = "indigo";
  ctx.fillRect(playerPositions.player6.x, playerPositions.player6.y, 5, 5);
}

function drawPlayer7(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player7.x - 5, playerPositions.player7.y - 5, 20, 20);
  ctx.fillStyle = "violet";
  ctx.fillRect(playerPositions.player7.x, playerPositions.player7.y, 5, 5);
}


function drawPlayer8(){
ctx.fillStyle = "white";
  ctx.fillRect(playerPositions.player8.x - 5, playerPositions.player8.y - 5, 20, 20);
  ctx.fillStyle = "brown";
  ctx.fillRect(playerPositions.player8.x, playerPositions.player8.y, 5, 5);
}


function drawPlant(){
  ctx.fillStyle = "green";
  ctx.fillRect(plantX, plantY, plantWidth, plantHeight);
}


drawPlant();
nextGeneration();
var currentTick = 0;
function tick() {
  drawPlayer2();
  drawPlayer1();
  drawPlayer3();
  drawPlayer4();
drawPlayer5();
drawPlayer6();
drawPlayer7();
drawPlayer8();
  movePlayers();
  evaluateVictory();
  currentTick++;
  checkForFailure();
}

function checkForFailure() {
  if (bestPathFound.length && currentTick > bestPathFound.length) {
    nextGeneration();
  }
}
function movePlayers() {
  movePlayer('player1');
  movePlayer('player2');
  movePlayer('player3');
movePlayer('player4');
movePlayer('player5');
movePlayer('player6');
movePlayer('player7');
movePlayer('player8');

}

function pickDirection() {
  var directionToMove;
  // 90% chance to follow existing path. 10% chance for deviation
  if(bestPathFound.length >= currentTick && Math.random < 0.9) {
    return bestPathFound[currentTick];
  }

  if(!directionToMove) {
    switch(Math.floor(Math.random() * 4) + 1) { // Random number between ranges
      case 1:
        return 'left';
      case 2:
        return 'right';
      case 3:
        return 'up';
      case 4:
        return 'down';
    }
  }
}
function movePlayer(playerName) {
  var directionToMove = pickDirection();

  movesThisGeneration[playerName].push(directionToMove);
  switch(directionToMove) {
    case 'up':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x,
        y: playerPositions[playerName].y + 5,
      }
      break;
    case 'down':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x,
        y: playerPositions[playerName].y - 5,
      }
      break;
    case 'left':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x - 5,
        y: playerPositions[playerName].y,
      }
      break;
    case 'right':
      playerPositions[playerName] = {
        x: playerPositions[playerName].x + 5,
        y: playerPositions[playerName].y,
      }
      break;
  }

  correctPlayerPosition(playerName);

}

function correctPlayerPosition(playerName) {
  if( playerPositions[playerName].x < 0 ) {
    playerPositions[playerName].x = 0;
  }

  if( playerPositions[playerName].x > ctx.canvas.width) {
    playerPositions[playerName].x = ctx.canvas.width;
  }

  if( playerPositions[playerName].y < 0 ) {
    playerPositions[playerName].y = 0;
  }

  if( playerPositions[playerName].y > ctx.canvas.height ) {
    playerPositions[playerName].y = ctx.canvas.height;
  }
}

function evaluateVictory() {
  if(playerPositions.player1.x >= plantX && playerPositions.player1.x <= plantX + plantWidth) {
    if(playerPositions.player1.y >= plantY && playerPositions.player1.y <= plantY + plantHeight){
    declareVictor('player1');
  console.log(bestPathFound);
    }
  }  if(playerPositions.player2.x >= plantX && playerPositions.player2.x <= plantX + plantWidth) {
    if(playerPositions.player2.y >= plantY && playerPositions.player2.y <= plantY + plantHeight){
    declareVictor('player2');
  console.log(bestPathFound);
  }
  }

if(playerPositions.player3.x >= plantX && playerPositions.player3.x <= plantX + plantWidth) {
    if(playerPositions.player3.y >= plantY && playerPositions.player3.y <= plantY + plantHeight){
    declareVictor('player3');
  console.log(bestPathFound);
    }
  } 

if(playerPositions.player4.x >= plantX && playerPositions.player4.x <= plantX + plantWidth) {
    if(playerPositions.player4.y >= plantY && playerPositions.player4.y <= plantY + plantHeight){
    declareVictor('player4');
  console.log(bestPathFound);
    }
  } 


if(playerPositions.player5.x >= plantX && playerPositions.player5.x <= plantX + plantWidth) {
    if(playerPositions.player5.y >= plantY && playerPositions.player5.y <= plantY + plantHeight){
    declareVictor('player5');
  console.log(bestPathFound);
    }
  } 


if(playerPositions.player6.x >= plantX && playerPositions.player6.x <= plantX + plantWidth) {
    if(playerPositions.player6.y >= plantY && playerPositions.player6.y <= plantY + plantHeight){
    declareVictor('player6');
  console.log(bestPathFound);
    }
  } 


if(playerPositions.player7.x >= plantX && playerPositions.player7.x <= plantX + plantWidth) {
    if(playerPositions.player7.y >= plantY && playerPositions.player7.y <= plantY + plantHeight){
    declareVictor('player7');
  console.log(bestPathFound);
    }
  } 

if(playerPositions.player8.x >= plantX && playerPositions.player8.x <= plantX + plantWidth) {
    if(playerPositions.player8.y >= plantY && playerPositions.player8.y <= plantY + plantHeight){
    declareVictor('player8');
  console.log(bestPathFound);
    }
  } 
}

function declareVictor(playerName) {
  if(
    !bestPathFound.length ||
    bestPathFound.length > movesThisGeneration[playerName].length
  ) {
    bestPathFound = movesThisGeneration[playerName]
  }

  nextGeneration();
}

function nextGeneration() {
  currentTick = 0;

  playerPositions = {
    player1: {x: startingX, y: startingY},
    player2: {x: startingX, y: startingY},
    player3: {x: startingX, y: startingY},
player4: {x: startingX, y: startingY},
player5: {x: startingX, y: startingY},
player6: {x: startingX, y: startingY},
player7: {x: startingX, y: startingY},
player8: {x: startingX, y: startingY}
  };

  movesThisGeneration = {
    player1: [],
    player2: [],
    player3: [],
    player4: [],
    player5: [],
    player6: [],
    player7: [],
    player8: []

  };

  generations++;
  document.getElementById("gen").innerHTML ="Number of generations so far: " + generations + " Moves to Plant: " + bestPathFound.length;
}

setInterval(tick, 1);



 
  </script>
</body>
</html>
